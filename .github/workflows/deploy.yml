name: Deploy to GitHub Pages

on:
  push:
    branches: [ master, web-integration ]

jobs:
  build-checkers:
    uses: ./.github/workflows/checkers.yml
    with:
      publish: true
  
  deploy-ghpages:
    needs: [build-checkers]
    runs-on: ubuntu-latest

    steps:
    - name: Download doc artifact
      uses: actions/download-artifact@v4
      with:
        name: doc
        path: .

    - name: Download web artifact
      uses: actions/download-artifact@v4
      with:
        name: web
        path: .

    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v4
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: .
        enable_jekyll: false
        allow_empty_commit: false
        force_orphan: true
